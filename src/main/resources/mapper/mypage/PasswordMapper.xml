<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper 
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.itwillbs.qtable.mapper.mypage.PasswordMapper">

	 <!-- 회원 비밀번호 가져오기 -->
    <select id="selectPasswordByMemberIdx" resultType="string" parameterType="int">
        SELECT member_pw FROM member WHERE member_idx = #{memberIdx}
    </select>

    <!-- 회원 비밀번호 변경 -->
    <update id="updatePassword" parameterType="map">
        UPDATE member
        SET member_pw = #{newPassword}
        WHERE member_idx = #{memberIdx}
    </update>
	
	<!-- 회원 닉네임 변경 -->
	<update id="updateNickname" parameterType="map">
	    UPDATE member
	    SET nickname = #{newNickname}
	    WHERE member_idx = #{memberIdx}
	</update>
	
	<!-- 닉네임  -->
	<select id="countNickname" parameterType="String" resultType="int">
        SELECT COUNT(*) FROM member WHERE nickname = #{nickname}
    </select>

	<!-- 음식 취향 삭제 -->
	<delete id="deleteByMemberIdx">
        DELETE FROM member_food
        WHERE member_idx = #{memberIdx}
    </delete>
	
	<!-- 음식 취향 선택 -->
    <insert id="insert">
        INSERT INTO member_food
        (
		 member_idx, 
         food_type
        )
        VALUES 
        (
		#{memberIdx}, 
		#{pref}
		)
    </insert>

	<!-- 음식 취향 검색 -->
    <select id="selectByMemberIdx" resultType="string">
        SELECT food_type
        FROM member_food
        WHERE member_idx = #{memberIdx}
    </select>
    
    <!-- 닉네임 빈 값 체크 -->
    <select id="selectMembersWithEmptyNickname" resultType="int">
    	SELECT member_idx FROM member
    	WHERE nickname IS NULL OR nickname = ''
	</select>

	<!-- 프로필 이미지 업로드 -->
	<update id="updateProfileImage">
		UPDATE member
  		SET profile_img_url = #{profileImgUrl}
  		WHERE member_idx = #{memberIdx}
	</update>


</mapper>
