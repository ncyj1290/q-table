<div th:fragment="storeInfoSection" xmlns:th="http://www.thymeleaf.org">
	  <!-- 1. 로그인 여부 체크 -->
  <div th:if="${#authorization.expression('isAuthenticated()')}">
      로그인 상태입니다<br>
      <span sec:authentication="principal.username"></span>님, 환영합니다!
  </div>

  <div th:if="${#authorization.expression('isAnonymous()')}">
      로그인이 필요합니다
  </div>
  
    

    <!-- 식당 정보 섹션 -->
    <div class="section-title">
        <div class="title-box">식당 정보</div>
    </div>
        <div class="store-header">
            <div class="store-image-container">
                <!-- 이미지 슬라이더 -->
                <div class="store-image-slider">
                    <img th:each="img, iterStat : ${store_images}"
                         th:src="@{${img}}"
                         th:class="${iterStat.index == 0} ? 'slider-image active' : 'slider-image'"
                         th:data-index="${iterStat.index}"
                         alt="매장 이미지">
                </div>

                <!-- 좌우 버튼 -->
                <div class="image-nav">
                    <button class="nav-button prev-button">◀</button>
                    <button class="nav-button next-button">▶</button>
                </div>

                <!-- 모든 사진 보기 버튼 -->
                <div class="image-label view-all-images">모든 사진 보기</div>
            </div>
            <div class="store-info">
                <h1 class="store-name" th:text="${store_name}"></h1>
                <div class="rating">
                    <div class="star-rating">
                        <div class="stars-background">★★★★★</div>
                        <div class="stars-filled" th:style="'width: ' + ${score.avgScore / 5 * 100} + '%;'">★★★★★</div>
                    </div>
                    <span class="rating-score" th:text="${score.avgScore}"></span>
                    <span class="rating-count" th:text="'(' + ${score.reviewCount} + '건)'"></span>
                </div>
                <div class="action-buttons">
	                <button class="positive-button action-btn">스크랩</button>
                    <button class="positive-button action-btn">문의하기</button>
                </div>
            </div>
        </div>

        <div class="horizontal-line"></div>

        <ul class="info-list">
            <li class="info-item">
                <span class="info-icon"><i class="fa-regular fa-clock"></i></span>
                <span class="info-label">영업 시간</span>
				<span class="info-content">
					<span th:if="${is_24hour}">24시간 영업</span>
					<span th:unless="${is_24hour}" th:text="${open_time_label} + ' ~ ' + ${close_time_label}"></span>
					<span th:if="${!holiday.isEmpty()}"
					      th:text="' (' + ${#strings.listJoin(holiday, ', ')} + ' 휴무)'"
					      style="color: #e74c3c;"></span>
				</span>
            </li>
            <li class="info-item">
                <span class="info-icon"><i class="fa-solid fa-phone"></i></span>
                <span class="info-label">식당 전화번호</span>
                <span class="info-content" th:text="${store_phone}"></span>
            </li>
            <li class="info-item">
                <span class="info-icon"><i class="fa-solid fa-map-location-dot"></i></span>
                <span class="info-label">오시는 길</span>
            </li>
        </ul>

        <div class="map-container">
            <!-- 카카오맵이 표시될 영역 -->
            <div id="map"></div>
        </div>
        <p class="map-address" th:text="${full_address}"></p>
        <a id="mapLink" href="#">지도 보기</a>

        
        <!-- 서버에서 받은 주소, 매장명 데이터 (JS에서 사용) -->
        <input type="hidden" id="mapAddress" th:value="${full_address}">
        <input type="hidden" id="storeName" th:value="${store_name}">

        <div class="horizontal-line"></div>

        <div class="info-item">
            <span class="info-icon"><i class="fa-solid fa-tags"></i></span>
            <span class="info-label">카테고리</span>
            <div class="tags">
                <span class="tag" th:each="category : ${categories}" th:text="${category}"></span>
            </div>
        </div>


        <div class="info-item">
            <span class="info-icon"><i class="fa-solid fa-chair"></i></span>
            <span class="info-label">매장 분위기</span>
            <div class="tags">
                <span class="tag" th:each="atm : ${atmosphere}" th:text="${atm}"></span>
            </div>
        </div>
		
		<div class="info-item">
            <span class="info-icon"><i class="fa-solid fa-bell-concierge"></i></span>
            <span class="info-label">편의시설</span>
            <div class="tags">
                <label class="tag tag-icon" th:each="amenity : ${amenities}">
                    <img th:src="@{'/icons/store_facility/' + ${amenity['amenityCode']} + '.png'}"
                         th:alt="${amenity['amenityName']}"
                         class="facility-icon">
                    <span th:text="${amenity['amenityName']}"></span>
                </label>
            </div>
        </div>

        <div class="info-item">
            <span class="info-icon"><i class="fa-solid fa-store"></i></span>
            <span class="info-label">매장 소개</span>
        </div>
        <div class="store-intro" th:text="${store_content}"></div>

    <!-- 모든 이미지 보기 모달 -->
    <div id="allImagesModal" class="all-images-modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2 class="modal-title">매장 사진</h2>
            <div class="images-grid">
                <div class="grid-image" th:each="img : ${store_images}">
                    <img th:src="@{${img}}" alt="매장 이미지">
                </div>
            </div>
        </div>
    </div>
</div>
