<html xmlns:th="http://www.thymeleaf.org">
<body>
   <div th:fragment="HeaderFragment">
	  <link rel="stylesheet" th:href="@{/css/header.css}">
	  <script th:src="@{/js/common/header.js}"></script>	  
      <header class="header">
         <!-- 로고 -->
         <a th:href="@{/}">
            <img th:src="@{/img/logo.PNG}" alt="로고">
         </a>
         <!-- 검색창 -->
         <th:block th:if="${isSearch}">
            <div class="search-box">
               <input type="text" placeholder="검색어를 입력하세요" id="query">
               <div class="date-area">
                  <span class="seperator">|</span>
                  <span class="rsv-date">날짜</span>
                  <span class="rsv-time">시간</span>
                  <span class="rsv-person-count">인원선택</span>
               </div>
               <i class="fas fa-search" id="search-btn"></i>
            </div>
         </th:block>
         <th:block th:unless="${isSearch}">
            <div class="search-box">
               <a href="/search" class="search-btn">
               <span>내가 원하는 맛집을 찾아보세요!</span>
                  <i class="fas fa-search"></i>
               </a>
            </div>
         </th:block>
             <!-- 로그인 상태: 아이콘만 표시 -->
             <div sec:authorize="isAuthenticated()">
                 <div class="menu-icons">
					<a href="#" id="openModalBtn">
					  <img src="/img/header_month.png" alt="달력">
					</a>
					 <div id="calendarModal" class="modal">
					   <div class="modal-content">
					     <span class="close-btn">&times;</span>
					     <!-- 여기는 나중에 달력이나 내용 추가 가능 -->
					   </div>
					 </div>
                     <a th:href="@{/chat}"><img th:src="@{/img/header_messenger.png}" alt="메신저"></a>
					 <!-- 프로필 드롭다운 -->
					 <div class="profile-dropdown">
					     <img th:src="@{/img/header_profile.png}" alt="프로필" class="profile-icon">
					     <div class="dropdown-menu">
					         <!-- 프로필 정보 -->
							 
					         <div class="header-profile-info" onclick="location.href='/reservation_list'">
								<img th:src="${#authentication.principal.member.profileImgUrl}" alt="프로필 사진" class="header-profile-img">
					             <div class="user-details">
					                 <span th:text="${#authentication.principal.member.nickName} + '님'"></span>
					                 <div class="user-email"><span sec:authentication="principal.member.email"></span></div>
					             </div>
					         </div>
 
					         <!-- 메뉴 항목 -->
					         <a th:href="@{/profile_settings}">프로필 편집</a>
					         <a th:href="@{/reservation_list}">예약현황</a>
					         <a th:href="@{/mypage_history}">방문내역</a>
					         <a th:href="@{/mypage_scrap}">스크랩가게</a>

					         <!-- 로그아웃 강조 -->
							 <form th:action="@{/logout}" method="post">
							     <button type="submit" class="logout">로그아웃</button>
							 </form>
					     </div>
					 </div>
                 </div>
             </div>

             <!-- 비로그인 상태 -->
             <div sec:authorize="isAnonymous()">
               <div class="loginoff">
                 <a th:href="@{/login}">로그인/등록</a>
               </div>
             </div>
      </header>
      <div class="horizontal-line">
      </div>
   </div>

</body>
</html>
